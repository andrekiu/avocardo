// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var $$Array = require("rescript/lib/js/array.js");
var Curry = require("rescript/lib/js/curry.js");
var Belt_Option = require("rescript/lib/js/belt_Option.js");
var Caml_option = require("rescript/lib/js/caml_option.js");

var Internals = {};

function gen(param) {
  var randomPool = new Uint8Array(32);
  crypto.getRandomValues(randomPool);
  return $$Array.fold_left((function (sum, e) {
                return sum + e.toString(16);
              }), "", randomPool);
}

function sync(cb) {
  chrome.storage.sync.get("userid", (function (items) {
          var userid = items.userid;
          if (!(userid == null)) {
            return Curry._1(cb, Belt_Option.getExn((userid == null) ? undefined : Caml_option.some(userid)));
          }
          var hash = gen(undefined);
          chrome.storage.sync.set({
                userid: hash
              }, (function (param) {
                  return Curry._1(cb, hash);
                }));
          
        }));
  
}

var get = sync;

exports.Internals = Internals;
exports.gen = gen;
exports.sync = sync;
exports.get = get;
/* No side effect */
